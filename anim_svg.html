<!DOCTYPE html>
<html>
<head>
	<title>Frontend. Формат зображень SVG</title>
	<meta charset="utf-8">
	<meta name="keywords" content="">
	<meta name="description" content="">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="format-detection" content="telephone=no">
	<link type="text/css" rel="stylesheet" href="style.css">
</head>
<body>
<div id="mainwrapper">
	<div class="resize">

		<h1>Формат зображень SVG.</h1>

		<!-- TODO: svg-групи http://css.yoksel.ru/svg-groups-use/ -->

		<p>SVG - векторний формат зображень. Це означає, що будь-яке SVG-зображення добре маштабується, зберігаючи чіткість зображення.</p>

		<div class="image">
			<img src="img/cat.svg" alt="cat" width="32">
			<p>Маленьке зображення.</p>
		</div>

		<div class="image">
			<img src="img/cat.svg" alt="cat" width="200">
			<p>Збільшене зображення.</p>
		</div>

		<div class="image">
			<div style="width:100%;height:400px;overflow:scroll;">
				<div style="width:2000px;height:2000px;">
					<img src="img/cat.svg" alt="cat" width="2000">
				</div>
			</div>
			<p>Сильно збільшене зображення.</p>
		</div>

		<section>
			<h2>Вставка SVG у веб-сторінку у якості звичайної картинки.</h2>
			<p>Створіть html-файл і вставне у нього SVG-файл в якості атрибута тега img.</p>
			<p>Спробуйте різні розміри для цього зображення:</p>
			<code>
				&lt;html&gt;<br>
				&lt;body&gt;<br>
				&nbsp;&nbsp;&lt;img src="cat.svg" alt="cat" width="32"&gt;&lt;br&gt;<br>
				&nbsp;&nbsp;&lt;img src="cat.svg" alt="cat" width="400"&gt;&lt;br&gt;<br>
				&nbsp;&nbsp;&lt;img src="cat.svg" alt="cat" width="1200"&gt;&lt;br&gt;<br>
				&lt;/body&gt;<br>
				&lt;/html&gt;
			</code>
		</section>

		<section>
			<h2>Формат SVG</h2>
			<p>Відкрийте ваш SVG-файл у IDE або текстовому редакторі.</p>
			<p>Як бачимо, формат файла - звичайний текстовий, використовує синтаксис XML.</p>
			<p>Зображення створюється за допомогою примітивів, описаних тегами і атрибутами.</p>
			<p>Можна вставити SVG-зображення у веб-сторінку (при чому, теги Doctype та xml не потрібні):</p>
			<code>
				&lt;html&gt;<br>
				&lt;body&gt;<br>
				&nbsp;&nbsp;&lt;svg version="1.1" id="Capa_1" ...<br>
				&nbsp;&nbsp;&nbsp;&nbsp;&lt;g&gt;<br>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;path d="M540.27,671.672c-0.492,0.493- ...<br>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br>
				&nbsp;&nbsp;&nbsp;&nbsp;&lt;/g&gt;<br>
				&nbsp;&nbsp;&lt;/svg&gt;<br>
				&lt;/body&gt;<br>
				&lt;/html&gt;
			</code>
			<p>Youtube: <a href="https://www.youtube.com/watch?v=TNX0-JLdM_U" target="_blank">HTML Шорти - Як правильно вставляти SVG</a> (4:24).</p>
			<p>Кожен тег - це примітив, лінія, окружність, область на зображенні.</p>
			<p>&nbsp;</p>
			<p><strong>Розглянемо атрибути тега svg.</strong></p>
			<p>Тегу можна задавати атрибути id, class, data-* та інші.</p>
			<p><strong>width, height</strong> - стандартні атрибути тегів, бажано видалити і задавати через стилі.</p>
			<p><strong>x, y</strong> - координати початку малюнку в пікселях.</p>
			<p><strong>viewBox</strong> - видима область, в умовних одиницях.</p>
			<p><strong>style="enable-background:new 0 0 890.982 890.982;"</strong> - підкладка (рос. - подложка).</p>
			<p>При створенні власних зображень задавайте розмір зображення і підкладки 100 х 100, для зручності обчислень (ну чи 100 х 250, 70 х 100, щоб один з розмірів був 100).</p>
			<code>
				&lt;svg viewBox="0 0 100 100"&gt;
			</code>
			<p>Згодом стандарти стають суворішими. Можливо, в майбутньому SVG не будуть відображатися без namespaces, тому не забувайте їх прописувати:</p>
			<code>
				&lt;svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"&gt;
			</code>
			<p>Тепер можна працювати з тегами як з елементами DOM: задавати їм стилі, модифікувати їх, реагувати на події.</p>
			<p>Першим чином поексперементуємо зі стилями. Їх можна напряму в теги прописувати:</p>
			<code>
				&lt;path style="..."
			</code>
			<p>Але краще працювати з класами, як і зі звичайними тегами:</p>
			<code>
				&lt;style&gt;<br>
				&nbsp;&nbsp;.someclass { ... }<br>
				&lt;/style&gt;<br>
				&lt;path class="someclass" ...
			</code>
			<p>Та для формату SVG нам доведеться вивчити трохи нових стилів.</p>
			<p><strong>fill</strong> - колір зафарбовування.</p>
			<p><strong>stroke</strong> - колір ліній.</p>
			<p><strong>stroke-width</strong> - товщина ліній.</p>
			<p>Ці всі стилі можна задавати у якості атрибутів тега: &lt;path fill="red" ...</p>
			<p>Якщо у вас в зображенні є теги &lt;path&gt; - це області, вони можуть мати зафарбовування. Поексперементуйте, додавши їм клас і колір:</path>
			<code>
				path { fill: #5a5a5a; }<br>
				.path1 { fill: red; }<br>
				#path2 { fill: blue; }<br>
				.path3 { fill: green; opacity: 0.3; }
			</code>
			<p>Одразу можна спробувати і події:</p>
			<code>
				.path3:hover { opacity: 1; }<br>
				&lt;script&gt;<br>
				&nbsp;&nbsp;path2.onclick = function(){ alert('hello'); }<br>
				&lt;/script&gt;
			</code>
		</section>
		
		<section>
			<h2>Створення та модифікація SVG</h2>
			<p>Зображення в форматі SVG можна створювати в програмі Adobe Illustrator, деяких інших графічних програмах та програмах створення/роботи зі шрифтами.</p>
			<p>Є онлайн-редактори, в яких можна створювати ці зображення.</p>
			<p>Наступні дії можна виконувати і програмно, скриптами JS, jQuery і т.ін.</p>
			<p><strong>Теги SVG.</strong></p>
			<p>Зауважте, оскільки використовується формат XML, а не html5, то всі теги мають закриватися.</p>
			<p><strong>&lt;g&gt;</strong> - група об'єктів, тег просто групує примітиви для зручності роботи з ними.</p>
			<p><strong>&lt;line x1="100" y1="300" x2="300" y2="100" /&gt;</strong></p>
			<p>stroke-linecap - стиль для промальовки кінчиків лінії, може приймати значення butt, square, round.</p>
			<p>stroke-dasharray="5, 5, 1, 5" - стиль, що задає переривчастий тип лінії.</p>
			<p><strong>&lt;rect x="400" y="100" width="400" height="200" /&gt;</strong></p>
			<p>Прямокутнику можна добавити скруглення кутів: &lt;rect ... rx="15" ry="15" /&gt;</p>
			<p><strong>&lt;polyline points="50,375 150,375 150,325 250,325" /&gt;</strong></p>
			<p><strong>&lt;polygon points="50,375 150,375 150,325 250,325" /&gt;</strong></p>
			<p>stroke-linejoin - стиль для промальовки з'єднань ліній, може приймати значення miter, bevel, round.</p>
			<p><strong>&lt;circle cx="150" cy="100" r="100" /&gt;</strong></p>
			<p><strong>&lt;ellipse cx="100" cy="100" rx="70" ry="40" /&gt;</strong></p>
			<p>Елементи можна трансформувати стилями чи через атрибут:</p>
			<code>
				ellipse { transform: rotate(-30) translate(900 200); }<br>
				&lt;ellipse transform="rotate(-30) translate(900 200)" ...
			</code>
			<p><strong>&lt;text x="100" y="100"&gt;hello&lt;/text&gt;</strong></p>
			<code>
				text { font-size: 40px; line-heigh:48px; stroke: red; fill: blue; letter-spacing: 4px; text-transform: uppercase;}
			</code>
			<p><strong>&lt;image xlink:href="123.jpg" x="50" y="100" width="678" height="435"/&gt;</strong></p>
			<p>У даному випадку адреса картинки використовує namespace xlink, тому ящо не прописати цей xmlns:xlink в тезі svg - шлях до картинки не буде знайдено.</p>
			<p><strong>&lt;path d="M 50 50 L 32.5 12.3 z" /&gt;</strong></p>
			<p><strong>M 50 50</strong> - перемістити точку в позицію x=50, y=50.</p>
			<p><strong>L 32.5 12.3</strong> - провести лінію до вказаної точки.</p>
			<p><strong>m 50 -50</strong> - перемістити точку в нову позицію відносно попередньої координати x=+50, y=-50.</p>
			<p><strong>l 32.5 12.3</strong> - провести лінію до точки, що розташована від попередньої на вказані відстані.</p>
			<p><strong>z</strong> - повернутися в початкову точку M</p>
			<p><strong>H 40</strong> - провести горизонтальну лінію до x=40.</p>
			<p><strong>V 24</strong> - провести вертикальну лінію до y=24.</p>
			<p><strong>h -40</strong> - провести горизонтальну лінію на 40 вліво.</p>
			<p><strong>v 24</strong> - провести вертикальну лінію на 24 вниз.</p>
		</section>

		<section>
			<h2>Завдання</h2>
			<ol>
				<li>Створіть сторінку index.html.</li>
				<li>Намалюйте сніговичка у SVG.</li>
				<li>Знайдіть в інтернеті картинку "План квартир на поверсі", вставте у сторінку.</li>
				<li>Поверх картинки накладіть SVG-зображення з контурами квартир, напівпрозорим кольоровим фоном.</li>
				<li>Добавте hover-ефект (зменшення рівня прозорості) на кожен фрагмент.</li>
				<li>При кліку на кожен фрагмент повинні відкриватися сторінки flat1.html, flat2.html, flat3.html...</li>
			</ol>
		</section>

		<section>
			<h2>Дуги та криві Безьє</h2>
			<!--<p><a href="https://svg-art.ru/?page_id=900">Дуги та криві Бєзьє</a>.</p>-->
			<p><strong>Дуга еліпса - A, a</strong></p>
			<p>Дуга малюється починаючи з останньої точки попереднього відрізка і має багато аргументів:</p>
			<code>
				d="... <strong>A rx,ry x-axis-rotation large-arc-flag sweep-flag x,y</strong><br><br>
				&lt;path d="M 50,50 A 75,50 45 0 1 160,140" /&gt;<br>
				&lt;path d="M 50,50 a 75,50 45 0 1 160,140" /&gt;
			</code>
			<p><em>rx,ry</em> - радіуси еліпса, частиною якого буде дуга.</p>
			<p><em>x-axis-rotation</em> - поворот осі X еліпса за годинниковою стрілкою.</p>
			<p><em>large-arc-flag</em> - прапорець, приймає значення 0 або 1; 0 - дуга меншого розміру, 1 - дуга більшого розміру.</p>
			<p><em>sweep-flag</em> - прапорець, приймає значення 0 або 1; 0 - дуга малюватиметься проти годинникової стрілки, 1 - за годинниковою стрілкою.</p>
			<p><em>x,y</em> - кінцева точка дуги.</p>
			<p><strong>Крива Безьє - Q, C</strong></p>
			<p>Про криві Безьє можна почитати у <a href="" target="_blank">Вікіпедії</a>.</p>
			<p>Квадратичні криві (Q) формуються по двох кінцевих та одній контрольній точках.</p>
			<p>Кубічні криві (C) формуються по двох кінцевих та двох контрольних точках.</p>
			<code>
				d="... <strong>Q x1,y1 x2,y2 x,y</strong><br>
				d="... <strong>C x1,y1 x2,y2 x,y</strong><br><br>
				&lt;path d="M 50,50 Q 100,50 100,100" /&gt;<br>
				&lt;path d="M 50,50 C 100,50 50,100 100,100" /&gt;
			</code>
			<p>З кубічних кривих можна побудувати полікриву, продовжуючи прописувати пари контрольних точок і кінцеву точку кожної кривої:</p>
			<code>
				&lt;path d="M 50,50 C 100,50 50,100 100,100 &nbsp;150,100 100,150 150,150" /&gt;
			</code>
			<p>Функція розрахунку координат конкретної точки на лінії Безьє:</p>
			<code>
				<em>/* t -> [0..1]  */<br>
				/* if 2 points: start, end */<br>
				/* if 3 points: start, middle, end */<br>
				/* if 4 points: start, start1, end1, end */</em><br><br>
				function bezierPoint(t, x1, y1, x2, y2, x3, y3, x4, y4) {<br>
				&nbsp;&nbsp;let x, y, T = 1 - t;<br>
				&nbsp;&nbsp;if (arguments.length > 8) {<br>
				&nbsp;&nbsp;&nbsp;&nbsp;x =  T ** 3 * x1 + 3 * T * T * t * x2 + 3 * T * t * t * x3 + t ** 3 * x4;<br>
				&nbsp;&nbsp;&nbsp;&nbsp;y =  T ** 3 * y1 + 3 * T * T * t * y2 + 3 * T * t * t * y3 + t ** 3 * y4;<br>
				&nbsp;&nbsp;} else if (arguments.length > 6) {<br>
				&nbsp;&nbsp;&nbsp;&nbsp;x = T * T * x1 + 2 * T * t * x2 + t * t * x3;<br>
				&nbsp;&nbsp;&nbsp;&nbsp;y = T * T * y1 + 2 * T * t * y2 + t * t * y3;<br>
				&nbsp;&nbsp;} else if (arguments.length > 4) {<br>
				&nbsp;&nbsp;&nbsp;&nbsp;x = T * x1 + t * x2;<br>
				&nbsp;&nbsp;&nbsp;&nbsp;y = T * y1 + t * y2;<br>
				&nbsp;&nbsp;}<br>
				&nbsp;&nbsp;return { x, y };<br>
				}
			</code>
		</section>

		<section>
			<h2>Градієнтне зафарбовування</h2>
			<p>Лінійне і радіальне зафарбовування представлено у <a href="https://jsfiddle.net/poshtarboba/sqw7tj4a/4/">jsFiddle</a>.</p>
			<p>Градієнти вказуються в окремому тезі - &lt;defs&gt;</p>
			<p>Кожен градієнт містить стоп-точки, між якими колір плавно переходить з одного в інший.</p>
			<p><strong>&lt;linearGradient&gt;</strong></p>
			<p><strong>&lt;radialGradient&gt;</strong></p>
			<p><strong>id</strong> - ідентифікатор градієнта, до якого звертаються примітиви, щоб отримати зафарбовування.</p>
			<p><strong>&lt;stop&gt;</strong> - стоп-точка кольору.</p>
			<p><strong>offset="0%"</strong> - положення стоп-точки; повинно бути щонайменше 2 точки з положеннями 0% і 100%.</p>
			<p><strong>stop-color="red"</strong> - колір стоп-точки.</p>
			<p><strong>stop-opacity="1"</strong> - прозорість стоп-точки.</p>
			<p>Градієнти ще мають декілька налаштувань, типу фокальної точки, повторення і т.п.</p>
		</section>

		<section>
			<h2>Завдання:</h2>
			<!--<p>1. Створіть декілька примітивів програмно, створіть обробники подій click, mouseenter, mouseleave, добавляйте, забирайте класи, прописуйте стилі безпосередньо в тег.</p>-->
			<ol>
				<li>Сервер видає дані про популярність поросят в інтернеті у вигляді <a href="js/pigs.json">JSON-файла</a>.<br>Побудуйте графік популярності поросят за тиждень.</li>
				<li>Побудуйте кругову діаграму сумарної популярності поросят у процентах.</li>
			</ol>
		</section>

		<section>
			<h2>Анімація</h2>
			<p><a href="http://snapsvg.io/">http://snapsvg.io/</a> - бібліотека для роботи з SVG та анімацією.</p>
			<p>Анімувати примітиви можна за допомогою наступних тегів:</p>
			<p><strong>&lt;animate&gt;</strong> - зміна числових атрибутів (і кольору) протягом певного часу.</p>
			<p><strong>&lt;set&gt;</strong> - зміна нечислових атрибутів (visible, font-style і т.п.)</p>
			<p><strong>&lt;animateMotion&gt;</strong> - рух елемента по заданій траекторії.</p>
			<p>Додаткові теги:</p>
			<p><strong>&lt;animateTransform&gt;</strong> - трансформація елемента.</p>
			<p><strong>&lt;mpath&gt;</strong> - вставляється в тег animateMotion, задає траекторію руху елемента своїм контуром.</p>
			<p><strong>&lt;animateMotion path="..."&gt;</strong> - модифікація контура.</p>
			<p><strong>&lt;animateMotion keypoints="..."&gt;</strong> - точки зміни швидкості руху.</p>
			<p><strong>&lt;animateMotion rotate="..."&gt;</strong> - дозволяє обертати елемент так, щоб він "завжди дивився вперед" по мірі руху по траекторії.</p>
			<p>&nbsp;</p>
			<p>Включення анімації в код можливий двома шляхами (подібно до взаємодії label &lt;==&gt; input):</p>
			<code>
				&lt;line id="line1" ... /&gt;<br>
				&lt;animation xlink:href="#cool_shape" ... /&gt;<br><br>
				&lt;line ... &gt;<br>
				&nbsp;&nbsp;&lt;animation ... /&gt;<br>
				&lt;/line&gt;
			</code>
			<p>Атрибути анімації:</p>
			<p><strong>attributeName</strong> - ім'я атрибута, який будемо міняти.</p>
			<p>В одній анімації можна міняти тільки один атрибут. Якщо потрібно міняти декілька атрибутів - створіть декілька анімацій.</p>
			<p><strong>attributeType</strong> - якщо міняти треба не XML-атрибут, а CSS, такий, як opacity, font-weight і т.п., то потрібно задати attributeType="CSS".</p>
			<p><strong>from</strong> - початкове значення атрибута.</p>
			<p><strong>to</strong> - кінцеве значення атрибута.</p>
			<p><strong>by</strong> - кінцеве відносне значення атрибута.</p>
			<p><strong>dur</strong> - тривалість анімації, наприклад, dur="3s".</p>
			<p><strong>repeatCount</strong> - кількість повторів, repeatCount="indefinite" - нескінченна анімація.</p>
			<p><strong>begin</strong> - подія, по якій повинна початися анімація, наприклад, begin="click", begin="4s" - по кліку і через 4 секунди після завантаження сторінки, begin="click + 2s".</p>
			<p><strong>fill</strong> - результат анімації: fill="freeze" - залишити елемент зміненим, fill="remove" - повернути елемент до початкового стану.</p>
			<code>
				&lt;circle cx="50" cy="100" r="70"&gt;<br>
					&nbsp;&nbsp;&lt;animate attributeName="cx" to="100" dur="4s" begin="click" fill="freeze"/&gt;<br>
					&nbsp;&nbsp;&lt;animate attributeName="cy" by="40" dur="4s" begin="click" fill="freeze"/&gt;<br>
					&nbsp;&nbsp;&lt;animate attributeName="r" from="50" to="100" dur="4s" begin="click" fill="remove"/&gt;<br>
					&nbsp;&nbsp;&lt;animate attributeType="CSS" attributeName="opacity" from="1" to="0.3" dur="2s" begin="click + 2s" fill="freeze"/&gt;<br>
				&lt;/circle&gt;
			</code>
			<p>Можна задати рух по ключовим кадрам:</p>
			<code>
				&lt;animate ... values="20; 40; 60" keyTimes="0; 0.3; 1" /&gt;
			</code>
			<p><strong>calcMode</strong> - атрибут, що задає плавність переходу між точками, calcMode="discrete" - різкий, calcMode="linear" - плавний, є ще значення paced і spline.</p>
			<p><strong>keySplines</strong> - атрибут, що задає плавність по типу CSS-властивості ease-in = cubic-bezier(0.47, 0, 0.745, 0.715).</p>
			<p>Цим атрибутом можна задати наприклад ефект гравітації - стрибаючий гумовий м'ячик.</p>
			<p>&nbsp;</p>
			<p>Атрибути тега animateMotion всі ті самі і ще три додаткових:</p>
			<p><strong>keyPoints</strong></p>
			<p><strong>rotate</strong> - прокручувати елемент по ходу руху, значення: auto, auto-reverse, число - градуси.</p>
			<p><strong>path</strong> - той самий формат, що і у атрибута &lt;path d="..."/&gt;.</p>
			<p>Використання примітиву &lt;path&gt; як траекторія руху об'єкта:</p>
			<code>
				&lt;animateMotion ... dur="1s" begin="click" fill="freeze"&gt;<br>
				&nbsp;&nbsp;&lt;mpath xlink:href="#motionPath"/&gt;<br>
				&lt;/animateMotion&gt;
			</code>
			<p>Текст по заданій траекторії:</p>
			<code>
				&lt;text&gt;<br>
				&nbsp;&nbsp;&lt;textpath xlink:href="#textpath"&gt;<br>
				&nbsp;&nbsp;&nbsp;&nbsp;Text laid out along a path.<br>
				&nbsp;&nbsp;&lt;/textpath&gt;<br>
				&lt;/text&gt;
			</code>
		</section>

		<p>Приклад анімації ліній (клікни по колу):</p>
		
		<svg id="svg1" width="230" height="230" fill="#080a1a">
			<circle cx="115" cy="115" r="110" stroke="#00ff00" fill="rgba(0,0,0,0.2)"  stroke-width="5" stroke-dasharray="1000" stroke-dashoffset="1000" style="cursor: pointer;">
				<animate attributeName="stroke-dashoffset" begin="svg1.click" values="1000; 0" dur="5s" repeatCount="1" fill="freeze" calcMode="linear"></animate>
			</circle>
		</svg>

		<code>
			&lt;svg id="svg1" width="230" height="230" fill="#080a1a"&gt;<br>
			&nbsp;&nbsp;&lt;circle cx="115" cy="115" r="110" fill="rgba(0,0,0,0.2)"<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stroke="#ff0000" stroke-width="5"<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stroke-dasharray="1000" stroke-dashoffset="1000"&gt;<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&lt;animate attributeName="stroke-dashoffset" begin="svg1.click"<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values="1000; 0" dur="5s" repeatCount="1" fill="freeze"<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;calcMode="linear"&gt;&lt;/animate&gt;<br>
			&nbsp;&nbsp;&lt;/circle&gt;
			</svg>
		</code>
		
	</div>
</div>

<script src="jquery-3.1.1.min.js"></script>
<script src="fe.js"></script>

</body>
</html>